<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <link rel="stylesheet" href="./css/style.css">
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <h1>Grid</h1>
    <button type="button" id="red"></button>
    <button type="button" id="blue"></button>
    <button type="button" id="green"></button>
    <script type="text/javascript">
      //down keeps track of wether or not the mouse is down
      let down = false;
      document.addEventListener('mousedown', function () {down = true;});
      document.addEventListener('mouseup', function() {down=false;});
      //initialize default mouse state
      let currMouseState = 'blue';
      function changeMouseState() {
            currMouseState = '' + this.id;
      }
      //sets the state of a square to the current mouse state
      function setSquareState() {
        //only run code if mousedown or a click has occured (*possible issues with double clicks)
        if (down || event.detail > 0) {
        //if square is green or red enable selector, set mouse state to square's value, reset square's value
          if (this.value === 'red' || this.value === 'green') {
            document.getElementById(this.value).disabled = false;
            currMouseState = this.value;
            this.value = '';
          } else if (currMouseState === 'red' || currMouseState === 'green') {
            document.getElementById(currMouseState).disabled = true;
            this.value = currMouseState;
            currMouseState = 'blue'
          } else if (this.value === 'blue') {
            currMouseState = this.value;
            this.value = '';
          } else {
            this.value = currMouseState;
          }
        }
      }
      //createGrid takes in a number of rows and a number of colums and creates a grid of buttons num of rows tall and num of columns wide
      function createGrid(row, col) {
        //for each row creates a seperate div
        for (let i = 0; i < row; i++) {
          let currentRow = document.createElement('div');
          let colId = 'row ' + i;
          currentRow.id = colId;
          document.body.appendChild(currentRow);
          //for each column creates a button and places it inside the current row's div adds an id and an onclick EventListener
          for (let j = 0; j < col; j++) {
            let currentCol = document.createElement('button');
            let currentColId = i + '-' + j;
            currentCol.id = currentColId;
            document.getElementById(colId).appendChild(currentCol);
            //*Issue the last square passed does not get set
            currentCol.addEventListener('mouseout', setSquareState);
            currentCol.addEventListener('click', setSquareState);
          }
        }
      }
      

    createGrid(20, 40);
    document.getElementById('red').addEventListener('click', changeMouseState);
    document.getElementById('blue').addEventListener('click', changeMouseState);
    document.getElementById('green').addEventListener('click', changeMouseState);
    //if click occurs change all squares the cursor passes until mouseup
    </script>
  </body>
</html>
